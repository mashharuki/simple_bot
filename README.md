# Hyperliquid FR Notification Bot

HyperliquidのFunding Rate (FR) を監視し、設定した閾値 (デフォルト: 1時間あたり ±0.01%) を超えた場合にTelegramで通知するPython製Botです。

## 特徴
- **リアルタイム監視**: 5分ごとにFRをチェックします (設定変更可能)。
- **異常値検知**: ロング過多 (正の乖離) とショート過多 (負の乖離) の両方を検知します。
- **Telegram通知**: 銘柄名、現在のFR、年率換算 (APR)、および傾向 (Long/Short Heavy) を詳細に通知します。
- **Docker対応**: 1コマンドで簡単にデプロイ・起動可能です。

## 前提条件
1. **Telegram Bot Token**:
    - Telegramで [@BotFather](https://t.me/BotFather) に話しかけます。
    - `/newbot` コマンドで新しいBotを作成し、HTTP API Tokenを取得してください。
2. **Chat ID**:
    - Telegramで [@userinfobot](https://t.me/userinfobot) (または類似のBot) に話しかけて、あなたのChat IDを取得してください。

## セットアップと起動

### 1. 設定 (Configure)
1. ルートディレクトリにある `.env.example` をコピーして、`.env` という名前のファイルを作成します:
   ```bash
   cp .env.example .env
   ```
2. `.env` を編集して値を設定してください (Python版と同じです)。

#### ボット用のAPIトークンとChat IDを取得する方法

1. Telegramで [@BotFather](https://t.me/BotFather) に話しかけます(認証バッジがついています)。
2. `/newbot` コマンドで新しいBotを作成し、HTTP API Tokenを取得してください。
3. 上記API Tokenを使って以下のページにアクセスしてください。

   ```bash
   https://api.telegram.org/bot<API_TOKEN>/getUpdates
   ```

   これでChat IDが取得できます。

### 2. Dockerで起動 (推奨)
```bash
docker compose up -d --build
```
ログを確認するには:
```bash
docker compose logs -f
```

### 3. ローカル (Bun) で起動
必要なもの: Bun (v1.0以上)

1. 依存関係をインストール:
   ```bash
   bun install
   ```
2. 開発モードで起動 (ホットリロード):
   ```bash
   bun run dev
   ```
   または、本番モード:
   ```bash
   bun run start
   ```

## 機能
- **Webサーバー**: `http://localhost:3000` でサーバーが起動します。
- **ヘルスチェック**: `GET /`
- **手動チェックトリガー**: `GET /check`
- **自動監視**: 設定された間隔（`CHECK_INTERVAL_SECONDS`）で自動的にチェックを実行します。

## コード品質 (Biome)
```bash
bun run check
```
でフォーマットとLintを実行します。

## 用語集 (初心者向け)

### 📈 ロングポジション (買い)
**「価格が上がる」** と予想して買うことです。
- **どうなれば儲かる？**: 買ったときより高く売れば利益になります。
- **イメージ**: 普通に「ビットコインを買って持っている」状態はロングポジションです。

### 📉 ショートポジション (売り/空売り)
**「価格が下がる」** と予想して売ることです。
- **どうなれば儲かる？**: 先に高く売っておき、安くなったときに買い戻せば利益になります。
- **イメージ**: FXや先物取引などで使える、「下落局面でも利益を出せる」方法です。

### 💰 Funding Rate (資金調達率 / 金利)
ロングとショートのバランスを取るための仕組みです。
- **プラス (+)** のとき: **ロングの人**が金利を支払います（買いが加熱している状態）。
- **マイナス (-)** のとき: **ショートの人**が金利を支払います（売りが加熱している状態）。
このBotは、この金利が「高すぎる」または「低すぎる」異常な状態を検知して通知します。

### 📅 APR (年換算利回り)
通知メッセージに出てくる「APR」のことです。
- **意味**: 「今のFunding Rateの状態がもし1年間続いたとしたら、年利何%になるか？」という計算値です。
- **なぜ見るの？**: 1時間の金利(FR)が `0.01%` と言われてもピンときませんが、APRで `87.6%` と言われると「ものすごい金利がついている！」と直感的に緊急度が分かります。

### 💧 Hyperliquid (ハイパーリキッド)
このBotが監視対象としている取引所のことです。
- **特徴**: ブロックチェーン上で動く次世代の取引所 (DEX) です。非常に動作が速く、多くのプロトレーダーも利用しています。